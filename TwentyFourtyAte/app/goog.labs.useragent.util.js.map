{
"version":3,
"file":"goog.labs.useragent.util.js",
"lineCount":82,
"mappings":"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",
"sources":["goog/labs/useragent/util.js"],
"sourcesContent":["/**\n * @license\n * Copyright The Closure Library Authors.\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * @fileoverview Utilities used by goog.labs.userAgent tools. These functions\n * should not be used outside of goog.labs.userAgent.*.\n *\n */\n\ngoog.module('goog.labs.userAgent.util');\ngoog.module.declareLegacyNamespace();\n\nconst {caseInsensitiveContains, contains} = goog.require('goog.string.internal');\nconst {useClientHints} = goog.require('goog.labs.userAgent');\n\n/**\n * @const {boolean} If true, use navigator.userAgentData without check.\n * TODO(user): FEATURESET_YEAR >= 2024 if it supports mobile and all the\n * brands we need.  See https://caniuse.com/mdn-api_navigator_useragentdata.\n */\nconst ASSUME_CLIENT_HINTS_SUPPORT = false;\n\n/**\n * Gets the native userAgent string from navigator if it exists.\n * If navigator or navigator.userAgent string is missing, returns an empty\n * string.\n * @return {string}\n */\nfunction getNativeUserAgentString() {\n  const navigator = getNavigator();\n  if (navigator) {\n    const userAgent = navigator.userAgent;\n    if (userAgent) {\n      return userAgent;\n    }\n  }\n  return '';\n}\n\n/**\n * Gets the native userAgentData object from navigator if it exists.\n * If navigator.userAgentData object is missing returns null.\n * @return {?NavigatorUAData}\n */\nfunction getNativeUserAgentData() {\n  const navigator = getNavigator();\n  // TODO(user): Use navigator?.userAgent ?? null once it's supported.\n  if (navigator) {\n    return navigator.userAgentData || null;\n  }\n  return null;\n}\n\n/**\n * Getter for the native navigator.\n * @return {!Navigator}\n */\nfunction getNavigator() {\n  return goog.global.navigator;\n}\n\n/**\n * A possible override for applications which wish to not check\n * navigator.userAgent but use a specified value for detection instead.\n * @type {?string}\n */\nlet userAgentInternal = null;\n\n/**\n * A possible override for applications which wish to not check\n * navigator.userAgentData but use a specified value for detection instead.\n * @type {?NavigatorUAData}\n */\nlet userAgentDataInternal = getNativeUserAgentData();\n\n/**\n * Override the user agent string with the given value.\n * This should only be used for testing within the goog.labs.userAgent\n * namespace.\n * Pass `null` to use the native browser object instead.\n * @param {?string=} userAgent The userAgent override.\n * @return {void}\n */\nfunction setUserAgent(userAgent = undefined) {\n  userAgentInternal =\n      typeof userAgent === 'string' ? userAgent : getNativeUserAgentString();\n}\n\n/** @return {string} The user agent string. */\nfunction getUserAgent() {\n  return userAgentInternal == null ? getNativeUserAgentString() :\n                                     userAgentInternal;\n}\n\n/**\n * Override the user agent data object with the given value.\n * This should only be used for testing within the goog.labs.userAgent\n * namespace.\n * Pass `null` to specify the absence of userAgentData. Note that this behavior\n * is different from setUserAgent.\n * @param {?NavigatorUAData} userAgentData The userAgentData override.\n */\nfunction setUserAgentData(userAgentData) {\n  userAgentDataInternal = userAgentData;\n}\n\n/**\n * If the user agent data object was overridden using setUserAgentData,\n * reset it so that it uses the native browser object instead, if it exists.\n */\nfunction resetUserAgentData() {\n  userAgentDataInternal = getNativeUserAgentData();\n}\n\n/** @return {?NavigatorUAData} Navigator.userAgentData if exist */\nfunction getUserAgentData() {\n  return userAgentDataInternal;\n}\n\n/**\n * Checks if any string in userAgentData.brands matches str.\n * Returns false if userAgentData is not supported.\n * @param {string} str\n * @return {boolean} Whether any brand string from userAgentData contains the\n *     given string.\n */\nfunction matchUserAgentDataBrand(str) {\n  if (!useClientHints()) return false;\n  const data = getUserAgentData();\n  if (!data) return false;\n  return data.brands.some(({brand}) => brand && contains(brand, str));\n}\n\n/**\n * @param {string} str\n * @return {boolean} Whether the user agent contains the given string.\n */\nfunction matchUserAgent(str) {\n  const userAgent = getUserAgent();\n  return contains(userAgent, str);\n}\n\n/**\n * @param {string} str\n * @return {boolean} Whether the user agent contains the given string, ignoring\n *     case.\n */\nfunction matchUserAgentIgnoreCase(str) {\n  const userAgent = getUserAgent();\n  return caseInsensitiveContains(userAgent, str);\n}\n\n/**\n * Parses the user agent into tuples for each section.\n * @param {string} userAgent\n * @return {!Array<!Array<string>>} Tuples of key, version, and the contents of\n *     the parenthetical.\n */\nfunction extractVersionTuples(userAgent) {\n  // Matches each section of a user agent string.\n  // Example UA:\n  // Mozilla/5.0 (iPad; U; CPU OS 3_2_1 like Mac OS X; en-us)\n  // AppleWebKit/531.21.10 (KHTML, like Gecko) Mobile/7B405\n  // This has three version tuples: Mozilla, AppleWebKit, and Mobile.\n\n  const versionRegExp = new RegExp(\n      // Key. Note that a key may have a space.\n      // (i.e. 'Mobile Safari' in 'Mobile Safari/5.0')\n      '([A-Z][\\\\w ]+)' +\n\n          '/' +                // slash\n          '([^\\\\s]+)' +        // version (i.e. '5.0b')\n          '\\\\s*' +             // whitespace\n          '(?:\\\\((.*?)\\\\))?',  // parenthetical info. parentheses not matched.\n      'g');\n\n  const data = [];\n  let match;\n\n  // Iterate and collect the version tuples.  Each iteration will be the\n  // next regex match.\n  while (match = versionRegExp.exec(userAgent)) {\n    data.push([\n      match[1],  // key\n      match[2],  // value\n      // || undefined as this is not undefined in IE7 and IE8\n      match[3] || undefined  // info\n    ]);\n  }\n\n  return data;\n}\n\nexports = {\n  ASSUME_CLIENT_HINTS_SUPPORT,\n  extractVersionTuples,\n  getNativeUserAgentString,\n  getUserAgent,\n  getUserAgentData,\n  matchUserAgent,\n  matchUserAgentDataBrand,\n  matchUserAgentIgnoreCase,\n  resetUserAgentData,\n  setUserAgent,\n  setUserAgentData,\n};\n"],
"names":["goog","module","declareLegacyNamespace","require","caseInsensitiveContains","contains","useClientHints","ASSUME_CLIENT_HINTS_SUPPORT","getNativeUserAgentString","navigator","getNavigator","userAgent","getNativeUserAgentData","userAgentData","global","userAgentInternal","userAgentDataInternal","setUserAgent","getUserAgent","setUserAgentData","resetUserAgentData","getUserAgentData","matchUserAgentDataBrand","str","data","brands","some","brand","matchUserAgent","matchUserAgentIgnoreCase","extractVersionTuples","versionRegExp","RegExp","match","exec","push","undefined","exports"]
}
